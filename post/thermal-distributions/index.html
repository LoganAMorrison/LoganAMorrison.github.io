<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.4.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Logan A. Morrison, PhD" />

  
  
  
    
  
  <meta name="description" content="An illustration of the equilibrium number, energy, pressure and entropy densities of relativistic thermal particles." />

  
  <link rel="alternate" hreflang="en-us" href="https://loganamorrison.github.io/post/thermal-distributions/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.1083c5683d81b407a892a791e534f8a7.css" />

  



  


  


  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://loganamorrison.github.io/post/thermal-distributions/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@wowchemy" />
    <meta property="twitter:creator" content="@wowchemy" />
  
  <meta property="og:site_name" content="Logan A. Morrison" />
  <meta property="og:url" content="https://loganamorrison.github.io/post/thermal-distributions/" />
  <meta property="og:title" content="Thermal Distribution Functions | Logan A. Morrison" />
  <meta property="og:description" content="An illustration of the equilibrium number, energy, pressure and entropy densities of relativistic thermal particles." /><meta property="og:image" content="https://loganamorrison.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://loganamorrison.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2019-08-21T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2019-08-21T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://loganamorrison.github.io/post/thermal-distributions/"
  },
  "headline": "Thermal Distribution Functions",
  
  "datePublished": "2019-08-21T00:00:00Z",
  "dateModified": "2019-08-21T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Logan A. Morrison"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Logan A. Morrison",
    "logo": {
      "@type": "ImageObject",
      "url": "https://loganamorrison.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "An illustration of the equilibrium number, energy, pressure and entropy densities of relativistic thermal particles."
}
</script>

  

  

  

  





  <title>Thermal Distribution Functions | Logan A. Morrison</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="9ba9f3688ca5ba4f44bef643105e014c" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.63a793a0158e186da77f80f308d537e2.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Logan A. Morrison</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Logan A. Morrison</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#posts"><span>Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#publications"><span>Publications</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Thermal Distribution Functions</h1>

  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span >
      Logan A. Morrison</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Aug 21, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    14 min read
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/field-theory/">Field Theory</a></span>
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <h2 id="introduction">Introduction</h2>
<p>In this notebook we wish to compute the thermal distribution functions for
fermions and bosons. The functions we wish to compute are the equilibirium
number, energy, pressure and entropy densities. In full form, these are given by:
$$\begin{align}
n(T) &amp;= g\int\dfrac{d^3k}{(2\pi)^2}f(\mathbf{k})\\\
\rho(T) &amp;= g\int\dfrac{d^3k}{(2\pi)^2}E(\mathbf{k})f(\mathbf{k})\\\
P(T) &amp;= g\int\dfrac{d^3k}{(2\pi)^2}\dfrac{|\mathbf{k}|^2}{3E(\mathbf{k})}f(\mathbf{k})
\end{align}$$
with $g$ representing the number of internal degrees of freedom (d.o.f),
$E^2 = k^2 + m^2$ and $f(\mathbf{k})$ is the phase-space distribution
function. For a species in kinetic equilibirium, the phase space distribution
is given by:
$$\begin{align}
f(\mathbf{k}) &amp;= \dfrac{1}{e^{E/T}\pm1}
\end{align}$$
where one takes the $+$ for fermions and $-$ for bosons. Note that we have
ignored the chemical potential in writing down $f$. Since $f(\mathbf{k})$ is
independent of angles, we can integrate of the solid angle and obtain:
$$\begin{align}
n(T) &amp;= \dfrac{g}{2\pi^2}\int_{m}^{\infty} dE \dfrac{E\sqrt{E^2-m^2}}{e^{E/T}\pm1}\\
\rho(T) &amp;= \dfrac{g}{2\pi^2}\int_{m}^{\infty} dE \dfrac{E^2\sqrt{E^2-m^2}}{e^{E/T}\pm1}\\
P(T) &amp;= \dfrac{g}{6\pi^2}\int_{m}^{\infty} dE \dfrac{(E^2-m^2)^{3/2}}{e^{E/T}\pm1}
\end{align}$$
We can further simplify these functions by defining: $z = E / T$ and
$x = m / T$. Doing so, we find</p>
<p>$$\begin{align}
n(T) &amp;= gT^3\bar{n}_{\pm}(x)\\\
\rho(T) &amp;= gT^4\bar{\rho}_{\pm}(x)\\\
P(T) &amp;= gT^4\bar{P}_{\pm}(x)
\end{align}$$</p>
<p>where we defined the &lsquo;barred&rsquo; quantities as:</p>
<p>$$\begin{align}
\bar{n}_{\pm}(x) &amp;= \dfrac{1}{2\pi^2}\int_{x}^{\infty} dz \dfrac{z\sqrt{z^2-x^2}}{e^{z}\pm1}\\
\bar{\rho}_{\pm}(x) &amp;= \dfrac{1}{2\pi^2}\int_{x}^{\infty} dz \dfrac{z^2\sqrt{z^2-x^2}}{e^{z}\pm1}\\
\bar{P}_{\pm}(x) &amp;= \dfrac{1}{6\pi^2}\int_{x}^{\infty} dz \dfrac{(z^2-x^2)^{3/2}}{e^{z}\pm1}
\end{align}$$</p>
<p>Let&rsquo;s define functions for these quantities. We will negelect $g$ and factors
of $T$ for now since they only contribute scaling.</p>
<pre><code class="language-julia">using QuadGK

&quot;&quot;&quot;
  nbar(x, stats)

Integral representation of n̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
&quot;&quot;&quot;
function nbar(x::Float64, stats::Symbol)
  pf::Float64 = 1 / (2π^2)
  function integrand(z::Float64)
    if stats == :boson
      return z * sqrt(z^2 - x^2) / (exp(z) - 1)
    elseif stats == :fermion
      return z * sqrt(z^2 - x^2) / (exp(z) + 1)
    else
      return 0.0
    end
  end
  return quadgk(integrand, x, Inf)[1] / (2π^2)
end

&quot;&quot;&quot;
  ρbar(x, stats)

Integral representation of ρ̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
&quot;&quot;&quot;
function ρbar(x::Float64, stats::Symbol)
  function integrand(z::Float64)
    if stats == :boson
      return z^2 * sqrt(z^2 - x^2) / (exp(z) - 1)
    elseif stats == :fermion
      return z^2 * sqrt(z^2 - x^2) / (exp(z) + 1)
    else
      return 0.0
    end
  end
  return quadgk(integrand, x, Inf)[1] / (2π^2)
end

&quot;&quot;&quot;
  pbar(x, stats)

Integral representation of p̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
&quot;&quot;&quot;
function pbar(x::Float64, stats::Symbol)
  function integrand(z::Float64)
    if stats == :boson
      return (z^2 - x^2)^1.5 / (exp(z) - 1)
    elseif stats == :fermion
      return (z^2 - x^2)^1.5 / (exp(z) + 1)
    else
      return 0.0
    end
  end
  return quadgk(integrand, x, Inf)[1] / (6π^2)
end;
</code></pre>
<p>Let&rsquo;s plot the results of these functions:</p>
<pre><code class="language-julia">import PyPlot; const plt = PyPlot # python plotting
using LaTeXStrings

xs = 10 .^(range(-1, stop=1, length=100))
nbar_fermions = [nbar(x, :fermion) for x in xs]
ρbar_fermions = [ρbar(x, :fermion) for x in xs]
pbar_fermions = [pbar(x, :fermion) for x in xs]

nbar_bosons = [nbar(x, :boson) for x in xs]
ρbar_bosons = [ρbar(x, :boson) for x in xs]
pbar_bosons = [pbar(x, :boson) for x in xs]

plt.figure(dpi=100)
plt.plot(xs, nbar_fermions, label=L&quot;$\bar{n}$ fermions&quot;)
plt.plot(xs, ρbar_fermions, label=L&quot;$\bar{\rho}$ fermions&quot;)
plt.plot(xs, pbar_fermions, label=L&quot;$\bar{P}$ fermions&quot;)

plt.plot(xs, nbar_bosons, &quot;--&quot;, label=L&quot;$\bar{n}$ bosons&quot;)
plt.plot(xs, ρbar_bosons, &quot;--&quot;, label=L&quot;$\bar{\rho}$ bosons&quot;)
plt.plot(xs, pbar_bosons, &quot;--&quot;, label=L&quot;$\bar{P}$ bosons&quot;)

plt.yscale(&quot;log&quot;)
plt.xscale(&quot;log&quot;)
plt.xlabel(L&quot;$x$&quot;, fontsize=16)
plt.ylim([1e-3, 1])
plt.xlim([1e-1, 1e1])
plt.legend()
plt.gcf()
</code></pre>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_2_1_hu1e69a7eac82d643e598b8db3a7f361a2_32243_0c5be179540cb710060d55ca9a1a83da.webp 400w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_2_1_hu1e69a7eac82d643e598b8db3a7f361a2_32243_f2025a9262cabb33e865e6d373e033aa.webp 760w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_2_1_hu1e69a7eac82d643e598b8db3a7f361a2_32243_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/thermal-distributions/2019-08-21-thermal-distribution-functions_2_1_hu1e69a7eac82d643e598b8db3a7f361a2_32243_0c5be179540cb710060d55ca9a1a83da.webp"
               width="563"
               height="440"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>There are a few things to take away from this plot. The first is that the
asymptotic behaviour as $x\to\infty$ is independent of statistics. The reseason
for this is clear: as $x\to\infty$, the integrand starts off with a very large
value of $z$ and hence, $e^{z} \gg \pm1$. The second thing to notice is that
the asymptotic behavior of $\bar{n}$ and $\bar{P}$ are identical, but they
differer from the asymptotic behavior of $\bar{\rho}$. The third thing to
notice is that the differences between fermions and bosons is small. We will
show why that&rsquo;s the case later on.</p>
<h2 id="asymptotic-forms">Asymptotic forms</h2>
<p>The integrals for the number, energy and pressure densities can be evaluated
exactly for $x\ll 1$ and $x\gg1$. If we set $x = 0$, then the results are:</p>
<p>$$
\begin{align}
\bar{n}(x) &amp;= \dfrac{\zeta(3)}{\pi^2}
\begin{cases}
1 &amp; \text{bosons}\\
3/4 &amp; \text{fermions}
\end{cases}\\
\bar{\rho}_{\pm}(x) &amp;= \dfrac{\pi^2}{30}
\begin{cases}
1 &amp; \text{bosons}\\
7/8 &amp; \text{fermions}
\end{cases}\\
\bar{P}_{\pm}(x) &amp;= \bar{\rho}/3
\end{align}
$$</p>
<p>In the opposite limit, we can simply ignore the statistics factors in the
denominators of the integral, obtaining:</p>
<p>$$
\begin{align}
\bar{n}(x) &amp;= e^{-x}\left(\frac{x}{2\pi}\right)^{3/2}\\
\bar{\rho}_{\pm}(x) &amp;= xe^{-x}\left(\frac{x}{2\pi}\right)^{3/2}\\
\bar{P}_{\pm}(x) &amp;= e^{-x}\left(\frac{x}{2\pi}\right)^{3/2}\\
\end{align}
$$</p>
<p>Let&rsquo;s check that these are correct:</p>
<pre><code class="language-julia">using SpecialFunctions
nbar_small_x_b = zeta(3)/π^2
nbar_small_x_f = 3/4 * zeta(3)/π^2
ρbar_small_x_b = π^2/30
ρbar_small_x_f = 7/8 * π^2/30
pbar_small_x_b = π^2/90
pbar_small_x_f = 7/8 * π^2/90

nbar_large_x(x::Float64) = exp(-x) * (x/(2π))^1.5
ρbar_large_x(x::Float64) = x * exp(-x) * (x/(2π))^1.5
pbar_large_x(x::Float64) = exp(-x) * (x/(2π))^1.5
</code></pre>
<pre><code class="language-julia">xs = 10 .^(range(-1, stop=0, length=100))
nbar_fermions = [nbar(x, :fermion) for x in xs]
ρbar_fermions = [ρbar(x, :fermion) for x in xs]
pbar_fermions = [pbar(x, :fermion) for x in xs]

nbar_bosons = [nbar(x, :boson) for x in xs]
ρbar_bosons = [ρbar(x, :boson) for x in xs]
pbar_bosons = [pbar(x, :boson) for x in xs]

plt.figure(dpi=100)
plt.subplot(2, 2, 1)
plt.title(&quot;Fermions&quot;)
plt.plot(xs, nbar_fermions)
plt.plot(xs, ρbar_fermions)
plt.plot(xs, pbar_fermions)

plt.plot(xs, [nbar_small_x_f for _ in xs], &quot;--&quot;, label=L&quot;$\bar{n}$ small x&quot;)
plt.plot(xs, [ρbar_small_x_f for _ in xs], &quot;--&quot;, label=L&quot;$\bar{\rho}$ small x&quot;)
plt.plot(xs, [pbar_small_x_f for _ in xs], &quot;--&quot;, label=L&quot;$\bar{P}$ small x&quot;)
plt.yscale(&quot;log&quot;)
plt.xscale(&quot;log&quot;)
plt.legend()

plt.subplot(2, 2, 2)
plt.title(&quot;Bosons&quot;)
plt.plot(xs, nbar_bosons)
plt.plot(xs, ρbar_bosons)
plt.plot(xs, pbar_bosons)
plt.plot(xs, [nbar_small_x_b for _ in xs], &quot;--&quot;, label=L&quot;$\bar{n}$ small x&quot;)
plt.plot(xs, [ρbar_small_x_b for _ in xs], &quot;--&quot;, label=L&quot;$\bar{\rho}$ small x&quot;)
plt.plot(xs, [pbar_small_x_b for _ in xs], &quot;--&quot;, label=L&quot;$\bar{P}$ small x&quot;)
plt.yscale(&quot;log&quot;)
plt.xscale(&quot;log&quot;)
plt.legend()

xs = 10 .^(range(0, stop=1, length=100))
nbar_fermions = [nbar(x, :fermion) for x in xs]
ρbar_fermions = [ρbar(x, :fermion) for x in xs]
pbar_fermions = [pbar(x, :fermion) for x in xs]

nbar_bosons = [nbar(x, :boson) for x in xs]
ρbar_bosons = [ρbar(x, :boson) for x in xs]
pbar_bosons = [pbar(x, :boson) for x in xs]

plt.subplot(2, 2, 3)
plt.plot(xs, nbar_fermions)
plt.plot(xs, ρbar_fermions)
plt.plot(xs, pbar_fermions)
plt.plot(xs, [nbar_large_x(x) for x in xs], &quot;--&quot;, label=L&quot;$\bar{n}$ large x&quot;)
plt.plot(xs, [ρbar_large_x(x) for x in xs], &quot;--&quot;, label=L&quot;$\bar{\rho}$ large x&quot;)
plt.plot(xs, [pbar_large_x(x) for x in xs], &quot;--&quot;, label=L&quot;$\bar{P}$ large x&quot;)
plt.yscale(&quot;log&quot;)
plt.xscale(&quot;log&quot;)
plt.xlabel(L&quot;$x$&quot;, fontsize=16)
plt.legend()

plt.subplot(2, 2, 4)
plt.plot(xs, nbar_bosons)
plt.plot(xs, ρbar_bosons)
plt.plot(xs, pbar_bosons)
plt.plot(xs, [nbar_large_x(x) for x in xs], &quot;--&quot;, label=L&quot;$\bar{n}$ large x&quot;)
plt.plot(xs, [ρbar_large_x(x) for x in xs], &quot;--&quot;, label=L&quot;$\bar{\rho}$ large x&quot;)
plt.plot(xs, [pbar_large_x(x) for x in xs], &quot;--&quot;, label=L&quot;$\bar{P}$ large x&quot;)
plt.yscale(&quot;log&quot;)
plt.xscale(&quot;log&quot;)
plt.xlabel(L&quot;$x$&quot;, fontsize=16)
plt.legend()

plt.tight_layout()
plt.gcf()
</code></pre>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_5_1_hu919eebb188a1bc8ade07cc6cd9d75b0f_52625_c9684bc50574191847c61ad29ae76059.webp 400w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_5_1_hu919eebb188a1bc8ade07cc6cd9d75b0f_52625_72e88b499117f4f3a991d3e1580dd733.webp 760w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_5_1_hu919eebb188a1bc8ade07cc6cd9d75b0f_52625_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/thermal-distributions/2019-08-21-thermal-distribution-functions_5_1_hu919eebb188a1bc8ade07cc6cd9d75b0f_52625_c9684bc50574191847c61ad29ae76059.webp"
               width="629"
               height="469"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h2 id="bessel-function-series-of-thermal-functions">Bessel Function Series of Thermal Functions</h2>
<p>The integrals for $\bar{n}(x), \bar{\rho}(x)$ and $\bar{P}(x)$ can be evaluated
exactly if one ignores the $\pm1$ in the denomiator of the integrands. This
suggests that one may be able to perform a series expansion of the denominator
in powers of $e^{-z}$ and evaluate the integrals exactly. This turns our to be
true. Note that:</p>
<p>$$\begin{align}
\dfrac{1}{e^{z}\pm1} &amp;= \sum_{n=1}^{\infty}(\mp1)^{n+1}e^{-nz}
\end{align}$$</p>
<p>Therefore, the functions $\bar{n}(x), \bar{\rho}(x)$ and $\bar{P}(x)$ can be
written as:</p>
<p>$$
\begin{align}
\bar{n}_{\pm}(x) &amp;= \dfrac{1}{2\pi^2}\sum_{n=1}^{\infty}(\mp1)^{n+1}\int_{x}^{\infty} dz e^{-nz}z\sqrt{z^2-x^2}\\
\bar{\rho}_{\pm}(x) &amp;= \dfrac{1}{2\pi^2}\sum_{n=1}^{\infty}(\mp1)^{n+1}\int_{x}^{\infty} dz e^{-nz}z^2\sqrt{z^2-x^2}\\
\bar{P}_{\pm}(x) &amp;= \dfrac{1}{6\pi^2}\sum_{n=1}^{\infty}(\mp1)^{n+1}\int_{x}^{\infty} dz e^{-nz}(z^2-x^2)^{3/2}
\end{align}
$$</p>
<p>These integrals can be represented as modified bessel functions of the second
kind:</p>
<p>$$
\begin{align}
\bar{n}_{\pm}(x) &amp;= \dfrac{x^2}{2\pi^2}\sum_{n=1}^{\infty}\dfrac{(\mp 1)^{n+1}}{n}K_{2}(nx)\\\
\bar{\rho}_{\pm}(x) &amp;= \dfrac{x^2}{2\pi^2}\sum_{n=1}^{\infty}\frac{(\mp 1)^{n+1}}{n^2}\left[n x K_{1}(nx)+3K_{2}(nx)\right]\\
\bar{P}_{\pm}(x) &amp;= \dfrac{x^2}{2\pi^2}\sum_{n=1}^{\infty}\frac{(\mp 1)^{n+1}}{n^2}K_{2}(nx)
\end{align}
$$</p>
<p>Let&rsquo;s make functions for these sums:</p>
<pre><code class="language-julia">using SpecialFunctions

&quot;&quot;&quot;
  nbar_bessel(x, stats, order)

Sum-of-bessel function representation of n̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
-`order::Int64`: number of terms in series to keep
&quot;&quot;&quot;
function nbar_bessel(x::Float64, stats::Symbol, order::Int64)
  bsum::Float64 = 0.0
  if stats == :fermion
    bsum = sum([(-1)^(n+1) / n * besselk(2, n*x) for n in 1:order])
  elseif stats == :boson
    bsum = sum([1 / n * besselk(2, n*x) for n in 1:order])
  end
  bsum * x^2 / (2π^2)
end

&quot;&quot;&quot;
  ρbar_bessel(x, stats, order)

Sum-of-bessel function representation of ρ̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
-`order::Int64`: number of terms in series to keep
&quot;&quot;&quot;
function ρbar_bessel(x::Float64, stats::Symbol, order::Int64)
  bsum::Float64 = 0.0
  if stats == :fermion
    bsum = sum([(-1)^(n+1) / n^2 * (n * x * besselk(1, n*x) +
                3 * besselk(2, n*x)) for n in 1:order])
  elseif stats == :boson
    bsum = sum([1 / n^2 * (n * x * besselk(1, n*x) +
                3 * besselk(2, n*x)) for n in 1:order])
  end
  bsum * x^2 / (2π^2)
end

&quot;&quot;&quot;
  pbar_bessel(x, stats, order)

Sum-of-bessel function representation of p̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
-`order::Int64`: number of terms in series to keep
&quot;&quot;&quot;
function pbar_bessel(x::Float64, stats::Symbol, order::Int64)
  bsum::Float64 = 0.0
  if stats == :fermion
    bsum = sum([(-1)^(n+1) / n^2 * besselk(2, n*x) for n in 1:order])
  elseif stats == :boson
    bsum = sum([1 / n^2 * besselk(2, n*x) for n in 1:order])
  end
  bsum * x^2 / (2π^2)
end;
</code></pre>
<p>Let&rsquo;s plot these functions and see that they are correct:</p>
<pre><code class="language-julia">xs = 10 .^(range(-1, stop=log10(3), length=100))

nrows = 2
ncols = 3

plt.figure(dpi=100)
for nrow in 1:nrows
  stats = (nrow == 1) ? :boson : :fermion
  for ncol in 1:ncols
    plt.subplot(nrows, ncols, ncols * (nrow - 1) + ncol)
    if ncol == 1
      plt.title(L&quot;$\bar{n}$ &quot; * string(stats))
      exact = [nbar(x, stats) for x in xs]
      approx1 = [nbar_bessel(x, stats, 1) for x in xs]
      approx5 = [nbar_bessel(x, stats, 5) for x in xs]
    elseif ncol == 2
      plt.title(L&quot;$\bar{p}$ &quot; * string(stats))
      exact = [pbar(x, stats) for x in xs]
      approx1 = [pbar_bessel(x, stats, 1) for x in xs]
      approx5 = [pbar_bessel(x, stats, 5) for x in xs]
    elseif ncol == 3
      plt.title(L&quot;$\bar{\rho}$ &quot; * string(stats))
      exact = [ρbar(x, stats) for x in xs]
      approx1 = [ρbar_bessel(x, stats, 1) for x in xs]
      approx5 = [ρbar_bessel(x, stats, 5) for x in xs]
    end
    plt.plot(xs, exact, lw=3, alpha=0.6, label=&quot;exact&quot;)
    plt.plot(xs, approx1, &quot;r--&quot;, label=&quot;n=1&quot;)
    plt.plot(xs, approx5, &quot;k--&quot;, label=&quot;n=1:5&quot;)
    plt.yscale(&quot;log&quot;)
    plt.xscale(&quot;log&quot;)
    plt.xlim([minimum(xs), maximum(xs)])
    if ncol == 3 &amp;&amp; nrow == 2
      plt.legend()
    end
  end
end

plt.tight_layout()
plt.gcf()
</code></pre>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_8_1_hu0019447d4fbb8735ea14e80f47f3b7c9_49575_20c01f773be2813f7de88a4d1b0c8d9c.webp 400w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_8_1_hu0019447d4fbb8735ea14e80f47f3b7c9_49575_ed9902173e7629aee4a42ec6c3bceba7.webp 760w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_8_1_hu0019447d4fbb8735ea14e80f47f3b7c9_49575_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/thermal-distributions/2019-08-21-thermal-distribution-functions_8_1_hu0019447d4fbb8735ea14e80f47f3b7c9_49575_20c01f773be2813f7de88a4d1b0c8d9c.webp"
               width="629"
               height="469"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>From these plots, we can see that even just the first term approximates the
thermal functions quite well. In practice, it is a good approximation to take:</p>
<p>$$
\begin{align}
\bar{n}_{\pm}(x) &amp;= \dfrac{x^2}{2\pi^2}K_{2}(x)\\\
\bar{\rho}_{\pm}(x) &amp;= \dfrac{x^2}{2\pi^2}\left[xK_{1}(x)+3K_{2}(x)\right]\\
\bar{P}_{\pm}(x) &amp;= \dfrac{x^2}{2\pi^2}K_{2}(x)
\end{align}
$$</p>
<p>These approximations have the added benifit of being independent of statistics.
The corrections for statistics come in when we include the second terms in the
sums. Let&rsquo;s plot the percent errors when only including the first and second
terms in the series:</p>
<pre><code class="language-julia">xs = 10 .^(range(-1, stop=log10(3), length=100))

nrows = 2
ncols = 3

plt.figure(dpi=100)
for nrow in 1:nrows
  stats = (nrow == 1) ? :boson : :fermion
  for ncol in 1:ncols
    plt.subplot(nrows, ncols, ncols * (nrow - 1) + ncol)
    if ncol == 1
      plt.title(L&quot;$\bar{n}$ &quot; * string(stats))
      exact = [nbar(x, stats) for x in xs]
      approx1 = [nbar_bessel(x, stats, 1) for x in xs]
      approx2 = [nbar_bessel(x, stats, 2) for x in xs]
      approx3 = [nbar_bessel(x, stats, 3) for x in xs]
    elseif ncol == 2
      plt.title(L&quot;$\bar{p}$ &quot; * string(stats))
      exact = [pbar(x, stats) for x in xs]
      approx1 = [pbar_bessel(x, stats, 1) for x in xs]
      approx2 = [pbar_bessel(x, stats, 2) for x in xs]
      approx3 = [pbar_bessel(x, stats, 3) for x in xs]
    elseif ncol == 3
      plt.title(L&quot;$\bar{\rho}$ &quot; * string(stats))
      exact = [ρbar(x, stats) for x in xs]
      approx1 = [ρbar_bessel(x, stats, 1) for x in xs]
      approx2 = [ρbar_bessel(x, stats, 2) for x in xs]
      approx3 = [ρbar_bessel(x, stats, 3) for x in xs]
    end
    if ncol == 1
      plt.ylabel(L&quot;$\%$ error&quot;)
    end
    plt.plot(xs, abs.(exact .- approx1) ./ exact .* 100, label=&quot;n=1&quot;)
    plt.plot(xs, abs.(exact .- approx2) ./ exact .* 100, label=&quot;n=1:2&quot;)
    plt.plot(xs, abs.(exact .- approx3) ./ exact .* 100, label=&quot;n=1:3&quot;)
    plt.xscale(&quot;log&quot;)
    #plt.yscale(&quot;log&quot;)
    plt.xlim([minimum(xs), maximum(xs)])
    plt.ylim([0, 20])
    if ncol == 1 &amp;&amp; nrow == 2
      plt.legend()
    end
  end
end

plt.tight_layout()
plt.gcf()
</code></pre>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_9_1_hu9f2b5e6b82f6b794785d24eb8d9e3559_38665_9f9bc5b6ead32807a3136cd0af00ccf8.webp 400w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_9_1_hu9f2b5e6b82f6b794785d24eb8d9e3559_38665_7678a102ffa0784075419c1ca6b30629.webp 760w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_9_1_hu9f2b5e6b82f6b794785d24eb8d9e3559_38665_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/thermal-distributions/2019-08-21-thermal-distribution-functions_9_1_hu9f2b5e6b82f6b794785d24eb8d9e3559_38665_9f9bc5b6ead32807a3136cd0af00ccf8.webp"
               width="629"
               height="469"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>From these plots, we can see that we are always within 20% of the actual value
even when only including the first term in the series. We see rapid global
convergence when we begin including higher order terms.</p>
<h2 id="entropy-density">Entropy Density</h2>
<p>In addition to the number, pressure and energy density, one also typical cares
about the entropy density. It can be shown that the entropy density is given
by:
$$\begin{align}
s(T) &amp;= \dfrac{\rho(T) + P(T)}{T} = gT^3(\bar{\rho}(x) + \bar{P}(x))
\end{align}$$
In integral form, this is:
$$\begin{align}
s(T) &amp;= gT^3\bar{s}(x)
\end{align}$$
where</p>
<p>$$
\begin{align}
\bar{s}(x) &amp;=  \bar{\rho}(x) + \bar{P}(x) = \dfrac{1}{6\pi^2}\int_{x}^{\infty} dz \dfrac{(4z^2-x^2)\sqrt{z^2-x^2}}{e^{z}\pm1}\
\end{align}
$$</p>
<p>In terms of bessel functions, this is:</p>
<p>$$
\begin{align}
\bar{s}(x) &amp;= \dfrac{x^3}{2\pi^2}\sum_{n=1}^{\infty}\dfrac{(\mp1)^{n+1}}{n}K_{3}(nx)
\end{align}
$$</p>
<h2 id="degrees-of-freedom-stored-in-energy-and-entropy">Degrees of Freedom Stored in Energy and Entropy</h2>
<p>When dealing with many species of particles, it is often useful to define the
energy and entropy density in terms of a single function:</p>
<p>$$
\begin{align}
\rho(T) &amp;= \sum_{i}\rho_{i}(T) = T^4\sum_{i}g_{i}\bar{\rho}_{i}(x) \equiv \dfrac{\pi^2}{30}g_{\mathrm{eff}}(T)T^4\\
s(T) &amp;= \sum_{i}s_{i}(T) = T^3\sum_{i}g_{i}\bar{s}_{i}(x) \equiv \dfrac{2\pi^2}{45}h_{\mathrm{eff}}(T)T^3
\end{align}
$$</p>
<p>where the sum runs over all particles and the effective number of relativistic
d.o.f. stored in energy and entropy $g_{\mathrm{eff}}$, $h_{\mathrm{eff}}$ are:</p>
<p>$$
\begin{align}
g_{\mathrm{eff}}(T) &amp;= \dfrac{30}{\pi^2}\sum_{i}g_{i}\bar{\rho}_{i}(x)\\\
h_{\mathrm{eff}}(T) &amp;= \dfrac{45}{2\pi^2}\sum_{i}g_{i}\bar{s}_{i}(x)
\end{align}
$$</p>
<h2 id="derivatives-of-thermal-functions">Derivatives of Thermal Functions</h2>
<p>Lastly, let&rsquo;s investigate the derivatives of the various functions. The
derivatives are:
$$\begin{align}
\dfrac{dn}{dT} &amp;= gT^2\left(3T\bar{n}(x)-x\dfrac{d\bar{n}}{dx}\right)\\\
\dfrac{d\rho}{dT} &amp;= gT^3\left(4T\bar{\rho}(x)-x\dfrac{d\bar{\rho}}{dx}\right)\\\
\dfrac{dP}{dT} &amp;= gT^3\left(4T\bar{P}(x)-x\dfrac{d\bar{P}}{dx}\right)\\\
\dfrac{ds}{dT} &amp;= gT^2\left(3T\bar{s}(x)-x\dfrac{d\bar{s}}{dx}\right)
\end{align}$$</p>
<p>We will want to compute derivatives of the barred quantities. All of the barred
quantities are of the form:
$$\begin{align}
\int_{x}^{\infty}f(x,z)dz
\end{align}$$
Using Leibniz&rsquo;s rule for differentiating integrals, one finds that:
$$\begin{align}
\dfrac{d}{dx}\int_{x}^{\infty}f(x,z)dz =
\int_{x}^{\infty}\dfrac{\partial f}{\partial x}dz - f(x, x)
\end{align}$$
Notice that all the integrand for our function evaluated at $z=x$ are zero.
Thus, we only need the integrate the derivative of the integrand w.r.t $x$. The
derivatives are:
$$\begin{align}
\dfrac{d\bar{n}}{dx} &amp;= -\dfrac{x}{2\pi^2}\int_{x}^{\infty}\dfrac{z}{(e^{z}-1)\sqrt{z^2-x^2}}\\
\dfrac{d\bar{\rho}}{dx} &amp;= -\dfrac{x}{2\pi^2}\int_{x}^{\infty}\dfrac{z^2}{(e^{z}-1)\sqrt{z^2-x^2}}\\
\dfrac{d\bar{P}}{dx} &amp;= -\dfrac{x}{2\pi^2}\int_{x}^{\infty}\dfrac{\sqrt{z^2-x^2}}{(e^{z}-1)}
\end{align}$$
Let&rsquo;s make some function for these and then invesigate how the look</p>
<pre><code class="language-julia">&quot;&quot;&quot;
  nbar_deriv(x, stats)

Derivative of the integral representation of n̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
&quot;&quot;&quot;
function nbar_deriv(x::Float64, stats::Symbol)
  pf::Float64 = 1 / (2π^2)
  function integrand(z::Float64)
    if stats == :boson
      return z / (exp(z) - 1) / sqrt(z^2 - x^2)
    elseif stats == :fermion
      return z / (exp(z) + 1) / sqrt(z^2 - x^2)
    else
      return 0.0
    end
  end
  return -x * quadgk(integrand, x, Inf)[1] / (2π^2)
end

&quot;&quot;&quot;
  ρbar_deriv(x, stats)

Derivative of the integral representation of ρ̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
&quot;&quot;&quot;
function ρbar_deriv(x::Float64, stats::Symbol)
  function integrand(z::Float64)
    if stats == :boson
      return z^2 / (exp(z) - 1) / sqrt(z^2 - x^2)
    elseif stats == :fermion
      return z^2 / (exp(z) + 1) / sqrt(z^2 - x^2)
    else
      return 0.0
    end
  end
  return -x * quadgk(integrand, x, Inf)[1] / (2π^2)
end

&quot;&quot;&quot;
  pbar_deriv(x, stats)

Derivative of the integral representation of p̄

# Arguments
-`x::Float64`: mass of particle divided by temperature
-`stats::Symbol`: `:boson` or `:fermion`
&quot;&quot;&quot;
function pbar_deriv(x::Float64, stats::Symbol)
  function integrand(z::Float64)
    if stats == :boson
      return sqrt(z^2 - x^2) / (exp(z) - 1)
    elseif stats == :fermion
      return sqrt(z^2 - x^2) / (exp(z) + 1)
    else
      return 0.0
    end
  end
  return -x * quadgk(integrand, x, Inf)[1] / (2π^2)
end;
</code></pre>
<p>Now let&rsquo;s plot:</p>
<pre><code class="language-julia">xs = 10 .^(range(-1, stop=1, length=100))
nbar_deriv_fermions = [nbar_deriv(x, :fermion) for x in xs]
ρbar_deriv_fermions = [ρbar_deriv(x, :fermion) for x in xs]
pbar_deriv_fermions = [pbar_deriv(x, :fermion) for x in xs]

nbar_deriv_bosons = [nbar_deriv(x, :boson) for x in xs]
ρbar_deriv_bosons = [ρbar_deriv(x, :boson) for x in xs]
pbar_deriv_bosons = [pbar_deriv(x, :boson) for x in xs]

plt.figure(dpi=100)
plt.plot(xs, nbar_deriv_fermions, label=L&quot;$d\bar{n}/dx$ fermions&quot;)
plt.plot(xs, ρbar_deriv_fermions, label=L&quot;$d\bar{\rho}/dx$ fermions&quot;)
plt.plot(xs, pbar_deriv_fermions, label=L&quot;$d\bar{P}/dx$ fermions&quot;)

plt.plot(xs, nbar_deriv_bosons, &quot;--&quot;, label=L&quot;$d\bar{n}/dx$ bosons&quot;)
plt.plot(xs, ρbar_deriv_bosons, &quot;--&quot;, label=L&quot;$d\bar{\rho}/dx$ bosons&quot;)
plt.plot(xs, pbar_deriv_bosons, &quot;--&quot;, label=L&quot;$d\bar{P}/dx$ bosons&quot;)

#plt.yscale(&quot;log&quot;)
plt.xscale(&quot;log&quot;)
plt.xlabel(L&quot;$x$&quot;, fontsize=16)
#plt.ylim([1e-3, 1])
plt.xlim([minimum(xs), maximum(xs)])
plt.legend()
plt.gcf()
</code></pre>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_12_1_hu39cb897a72c79f8387e2fcf2bc2e421c_53419_4231ed3c7c141cc5856c48e0230a7515.webp 400w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_12_1_hu39cb897a72c79f8387e2fcf2bc2e421c_53419_7a917f034b7d92cb16be111d8f88bd80.webp 760w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_12_1_hu39cb897a72c79f8387e2fcf2bc2e421c_53419_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/thermal-distributions/2019-08-21-thermal-distribution-functions_12_1_hu39cb897a72c79f8387e2fcf2bc2e421c_53419_4231ed3c7c141cc5856c48e0230a7515.webp"
               width="570"
               height="439"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>Next, let&rsquo;s investigate the sum-over-bessel function representation of the
derivatives. These are:</p>
<p>$$\begin{align}
\bar{n}_{\pm}(x) &amp;= -\dfrac{x^2}{2\pi^2}\sum_{n=1}^{\infty}(\mp1)^{n+1}K_{1}(nx)\\\
\bar{\rho}_{\pm}(x) &amp;= -\dfrac{x^2}{2\pi^2}\sum_{n=1}^{\infty}\frac{(\mp1)^{n+1}}{n}\left[nxK_{0}(nx)+K_{1}(nx)\right]\\
\bar{P}_{\pm}(x) &amp;= -\dfrac{x^2}{2\pi^2}\sum_{n=1}^{\infty}\frac{(\mp1)^{n+1}}{n}K_{1}(nx)
\end{align}$$</p>
<p>Let&rsquo;s make functions for these:</p>
<pre><code class="language-julia">using SpecialFunctions

function nbar_deriv_bessel(x::Float64, stats::Symbol, order::Int64)
  bsum::Float64 = 0.0
  if stats == :fermion
    bsum = sum([(-1)^(n+1) * besselk(1, n*x) for n in 1:order])
  elseif stats == :boson
    bsum = sum([besselk(1, n*x) for n in 1:order])
  end
  -bsum * x^2 / (2π^2)
end

function ρbar_deriv_bessel(x::Float64, stats::Symbol, order::Int64)
  bsum::Float64 = 0.0
  if stats == :fermion
    bsum = sum([(-1)^(n+1) / n * (n * x * besselk(0, n*x) +
                besselk(1, n*x)) for n in 1:order])
  elseif stats == :boson
    bsum = sum([1 / n * (n * x * besselk(0, n*x) +
                besselk(1, n*x)) for n in 1:order])
  end
  -bsum * x^2 / (2π^2)
end

function pbar_deriv_bessel(x::Float64, stats::Symbol, order::Int64)
  bsum::Float64 = 0.0
  if stats == :fermion
    bsum = sum([(-1)^(n+1) / n * besselk(1, n*x) for n in 1:order])
  elseif stats == :boson
    bsum = sum([1 / n * besselk(1, n*x) for n in 1:order])
  end
  -bsum * x^2 / (2π^2)
end;
</code></pre>
<p>Now let&rsquo;s plot to compare:</p>
<pre><code class="language-julia">xs = 10 .^(range(-2, stop=1, length=100))

nrows = 2
ncols = 3

plt.figure(dpi=100)
for nrow in 1:nrows
  stats = (nrow == 1) ? :boson : :fermion
  for ncol in 1:ncols
    plt.subplot(nrows, ncols, ncols * (nrow - 1) + ncol)
    if ncol == 1
      plt.title(L&quot;$\bar{n}$ &quot; * string(stats))
      exact = [nbar_deriv(x, stats) for x in xs]
      approx1 = [nbar_deriv_bessel(x, stats, 1) for x in xs]
      approx5 = [nbar_deriv_bessel(x, stats, 5) for x in xs]
    elseif ncol == 2
      plt.title(L&quot;$\bar{p}$ &quot; * string(stats))
      exact = [pbar_deriv(x, stats) for x in xs]
      approx1 = [pbar_deriv_bessel(x, stats, 1) for x in xs]
      approx5 = [pbar_deriv_bessel(x, stats, 5) for x in xs]
    elseif ncol == 3
      plt.title(L&quot;$\bar{\rho}$ &quot; * string(stats))
      exact = [ρbar_deriv(x, stats) for x in xs]
      approx1 = [ρbar_deriv_bessel(x, stats, 1) for x in xs]
      approx5 = [ρbar_deriv_bessel(x, stats, 5) for x in xs]
    end
    plt.plot(xs, exact, lw=3, alpha=0.6, label=&quot;exact&quot;)
    plt.plot(xs, approx1, &quot;r--&quot;, label=&quot;n=1&quot;)
    plt.plot(xs, approx5, &quot;k--&quot;, label=&quot;n=1:5&quot;)
    #plt.yscale(&quot;log&quot;)
    plt.xscale(&quot;log&quot;)
    plt.xlim([minimum(xs), maximum(xs)])
    if ncol == 3 &amp;&amp; nrow == 2
      plt.legend()
    end
  end
end

plt.tight_layout()
plt.gcf()
</code></pre>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_14_1_hu482d3b1ce6706dff3e45ed267245765c_68008_c4c4aab3029047290b566181e1f27c16.webp 400w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_14_1_hu482d3b1ce6706dff3e45ed267245765c_68008_abc42e1d5887aa3a7bd57b7b77d60670.webp 760w,
               /post/thermal-distributions/2019-08-21-thermal-distribution-functions_14_1_hu482d3b1ce6706dff3e45ed267245765c_68008_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/thermal-distributions/2019-08-21-thermal-distribution-functions_14_1_hu482d3b1ce6706dff3e45ed267245765c_68008_c4c4aab3029047290b566181e1f27c16.webp"
               width="630"
               height="469"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>

    </div>

    




<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/quantum-field-theory/">quantum-field-theory</a>
  
</div>













  
  
    




  
















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  

  
  






  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2022 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.3d946de2e8784a477845261d87025092.js"></script>

    
    
    
      
      
        <script src="https://cdn.jsdelivr.net/gh/desandro/imagesloaded@v4.1.4/imagesloaded.pkgd.min.js" integrity="sha512-S5PZ9GxJZO16tT9r3WJp/Safn31eu8uWrzglMahDT4dsmgqWonRY9grk3j+3tfuPr9WJNsfooOR7Gi7HL5W2jw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/metafizzy/isotope@v3.0.6/dist/isotope.pkgd.min.js" integrity="sha512-Zq2BOxyhvnRFXu0+WE6ojpZLOU2jdnqbrM1hmVdGzyeCa1DgM3X5Q4A/Is9xA1IkbUeDd7755dNNI/PzSf2Pew==" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/latex.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/cpp.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/julia.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/python.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/rust.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":true}</script>

    
    
      <script src="/js/wowchemy-headroom.e8fd2d733eef6a8bbbe0539398fc0547.js" type="module"></script>
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.a2ed145159dd33ad55ff402163350b5d.js"></script>

    
    
    
    
    
    
      
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      <script src="/js/wowchemy-publication.b0d291ed6d27eacec233e6cf5204f99a.js" type="module"></script>






</body>
</html>
